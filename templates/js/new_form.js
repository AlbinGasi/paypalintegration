$(function(){function e(e,l,a){for(var t=0;t<e.length;t++)$(e[t]).attr(l,a[t])}$("#createdFiles").sortable(),$("#createdFiles").disableSelection(),$("#around-elem").change(function(){"none"!=$(this).val()?e(["#around-id-elem","#around-class-elem"],"type",["text","text"]):e(["#around-id-elem","#around-class-elem"],"type",["hidden","hidden"])}),$("#tag-elem").change(function(){"textarea"==$(this).val()?(e(["#tag-cols-elem","#tag-rows-elem"],"type",["number","number"]),$("#type-elem").prop("disabled",!0),$("#value-elem").prop("disabled",!0)):(e(["#tag-cols-elem","#tag-rows-elem"],"type",["hidden","hidden"]),$("#type-elem").prop("disabled",!1),$("#value-elem").prop("disabled",!1))}),$("#row-elem").change(function(){"no"!=$(this).val()?e(["#row-id-elem","#row-class-elem"],"type",["text","text"]):e(["#row-id-elem","#row-class-elem"],"type",["hidden","hidden"])}),$("#label-elem").change(function(){"no"!=$(this).val()?e(["#label-class-elem","#label-for-elem","#label-name-elem"],"type",["text","text","text"]):e(["#label-class-elem","#label-for-elem","#label-name-elem"],"type",["hidden","hidden","hidden"])}),$("#vfk-elem").change(function(){"yes"==$(this).val()?($("#vfk-row-item").css("visibility","visible"),"label"==$("#vfk-label-elem").val().trim()?$("#vfk-place-name-elem").attr("type","hidden"):$("#vfk-place-name-elem").attr("type","text")):($("#vfk-row-item").css("visibility","hidden"),"label"==$("#vfk-label-elem").val().trim()&&$("#vfk-place-name-elem").attr("type","hidden"))}),$("#vfk-label-elem").change(function(){"label"==$(this).val().trim()?e(["#vfk-label-class-elem","#vfk-label-name-elem","#vfk-place-name-elem"],"type",["text","text","hidden"]):"placeholder"==$(this).val().trim()&&e(["#vfk-label-class-elem","#vfk-label-name-elem","#vfk-place-name-elem"],"type",["hidden","hidden","text"])}),$(document).on("mouseenter","#createdFiles .self-item",function(){var e="<button class='deleteItem' title='Delete'>X</button>";$(this).append(e)}),$(document).on("mouseleave","#createdFiles .self-item",function(){$(".deleteItem").remove()}),$(document).on("click",".deleteItem",function(){$(this).parent().fadeOut(300,function(){$(this).remove()}),1==$(".self-item").length&&$("#finish").html("")}),$("#createfiles").click(function(){var e=$("#tag-elem").val().trim(),l=$("#type-elem").val().trim(),a=$("#value-elem").val().trim(),t=$("#placeholder-elem").val().trim(),i=$("#name-elem").val().trim(),r=$("#id-elem").val().trim(),m=$("#class-elem").val().trim(),n=$("#required-elem").val().trim(),s="no";if($(".self-item input").each(function(){$(this).attr("name")==i&&(s="yes",alert("This name is already in use. \n Use another."))}),"yes"==s)return!1;var d=["input","textarea"];if(""==i||-1==$.inArray(e,d))return alert("Check your required fields! (*)"),!1;var o=["text","date","email","number"];if("textarea"!=e&&-1==$.inArray(l,o))return alert("Check your required fields! (*)"),!1;var c="<";if(c+=e,"textarea"==e){var v=""!=$("#tag-rows-elem").val().trim()?$("#tag-rows-elem").val().trim():"4",f=""!=$("#tag-cols-elem").val().trim()?$("#tag-cols-elem").val().trim():"30";c+=" rows='"+v+"' cols='"+f+"' "}"textarea"!=e&&(c+=" type='"+l+"' "),"textarea"!=e&&""!=a&&(c+="value='"+a+"' "),""!=t&&(c+="placeholder='"+t+"' "),""!=i&&(c+="name='"+i+"' "),""!=r&&(c+="id='"+r+"' "),""!=m&&(c+="class='"+m+"' "),n="no"==n?"":" required='required'",c+=" "+n+" />","textarea"==e&&(c+="</textarea>");var u="",h="",p="";"no"!=$("#label-elem").val().trim()&&(u=$("#label-class-elem").val().trim(),h=$("#label-for-elem").val().trim(),p=$("#label-name-elem").val().trim(),""!=u&&(u=" class='"+u+"'"),""!=h&&(h=" for='"+h+"'"),c="textarea"==e?"<label "+h+" "+u+"><span class='cfe-label cfe-textarea-item'>"+p+"</span> "+c+"</label>":"<label "+h+" "+u+"><span class='cfe-label'>"+p+"</span> "+c+"</label>"),c="<span class='self-item ui-sortable-handle'>"+c+"</span>";var b="",y="";"none"!=$("#around-elem").val().trim()&&(b=$("#around-class-elem").val().trim(),y=$("#around-id-elem").val().trim(),""!=b&&(b=" class='"+b+"'"),""!=y&&(y=" id='"+y+"'"),c="<div "+y+" "+b+">"+c+"</div>"),$("#createdFiles").append(c),$("#name-elem").val(""),$("#value-elem").val(""),$("#placeholder-elem").val(""),$("#id-elem").val(""),$("#label-for-elem").val(""),$("#label-name-elem").val(""),$("#around-id-elem").val(""),$(".self-item").length>0&&$("#finish").html('<button id="finishForm">FINISH</button>')}),$(document).on("click","#finishForm",function(){$(".self-item").removeClass("ui-sortable-handle"),$(".self-item").removeAttr("style");var e=$("#submit-elem").val().trim(),l=$("#createdFiles").html(),a=$("#vfk-elem").val().trim(),t=$("#vfk-label-elem").val().trim(),i="no",r="no";$("#createdFiles").find(".self-item").find("input").each(function(){"email"==$(this).attr("type")&&(i="yes","required"==$(this).attr("required")&&(r="yes"))});var m="",n="",s="";"yes"==a&&("label"==t?(m=$("#vfk-label-class-elem").val().trim(),n=$("#vfk-label-name-elem").val().trim(),""!=m&&(m=" class='"+m+"'")):"placeholder"==t&&(s=$("#vfk-place-name-elem").val().trim()));var d="no",o="",c="";"no"!=$("#row-elem").val().trim()&&(d="yes",o=$("#row-class-elem").val().trim(),c=$("#row-id-elem").val().trim(),""!=o&&(o=" class='"+o+"'"),""!=c&&(c="id='"+c+"'"));var v=[];$("#createdFiles").find(".self-item").find("input").each(function(){"required"==$(this).attr("required")&&v.push($(this).attr("name"))}),$("#createdFiles").find(".self-item").find("textarea").each(function(){"required"==$(this).attr("required")&&v.push($(this).attr("name"))}),v=v.join(),$.ajax({url:ajax+"/createfiles.php",type:"post",data:{createdFiles:l,submitValue:e,useVerification:a,useLabel:t,labelVerificationName:n,labelVerificationClass:m,placeVerificationName:s,useRow:d,rowClass:o,rowId:c,useEmail:i,emailReq:r,requiredFields:v},beforeSend:function(){},success:function(e){$("#finishedForm").css("display","block"),$("#finishedForm").html(e)}}),$(".self-item").addClass("ui-sortable-handle")})});